@prefix dcterms: <http://purl.org/dc/terms/> .
@prefix prez: <https://prez.dev/> .
@prefix rdf:  <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .

prez:skosWeighted a prez:SearchMethod ;
                        dcterms:identifier "skosPrefLabel" ;
    rdfs:label "SKOS PrefLabel Search"@en ;
    rdf:value """
        PREFIX skos: <http://www.w3.org/2004/02/skos/core#>
        PREFIX prez: <https://prez.dev/>

        {{
        SELECT DISTINCT ?search_result_uri ?match (SUM(?w) AS ?weight)
        WHERE {{
            {{  # exact match on a prefLabel always wins
                ?search_result_uri a skos:Concept ;
                    <http://www.w3.org/2004/02/skos/core#prefLabel> ?match ;
                    <http://www.w3.org/2004/02/skos/core#inScheme>|<http://www.w3.org/2004/02/skos/core#topConceptOf>|^skos:hasTopConcept ?cs .
                BIND (50 AS ?w)
                FILTER REGEX(?match, "^$TERM$$", "i")
            }}
            UNION
            {{
                ?search_result_uri a skos:Concept ;
                    skos:prefLabel ?match ;
                    skos:inScheme|skos:topConceptOf|^skos:hasTopConcept ?cs .
                BIND (10 AS ?w)
                FILTER REGEX(?match, "$TERM", "i")
            }}
        }}
        GROUP BY ?cs ?search_result_uri ?match ?sys
        }}
        """.
