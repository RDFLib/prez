@prefix ont: <https://prez.dev/ont/> .
@prefix dcat: <http://www.w3.org/ns/dcat#> .
@prefix dcterms: <http://purl.org/dc/terms/> .
@prefix ex: <http://example.org/ns#> .
@prefix geo: <http://www.opengis.net/ont/geosparql#> .
@prefix prez: <https://prez.dev/> .
@prefix prof: <http://www.w3.org/ns/dx/prof/> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix sh: <http://www.w3.org/ns/shacl#> .
@prefix shext: <http://example.com/shacl-extension#> .
@prefix skos: <http://www.w3.org/2004/02/skos/core#> .

ex:TopLevelCatalogs
    a sh:NodeShape ;
    ont:hierarchyLevel 1 ;
    sh:targetClass dcat:Catalog ;
    sh:property [
        sh:path dcterms:hasPart ;
        sh:or (
            [ sh:class dcat:Catalog ]
            [ sh:class geo:FeatureCollection ]
            [ sh:class skos:ConceptScheme ]
            [ sh:class skos:Collection ]
        ) ;
    ] .

ex:Collections
    a sh:NodeShape ;
    ont:hierarchyLevel 2 ;
    sh:targetClass geo:FeatureCollection , skos:ConceptScheme , skos:Collection , dcat:Catalog ;
    sh:property [
        sh:path [ sh:inversePath dcterms:hasPart ] ;
        sh:class dcat:Catalog ;
    ] .

ex:Feature
    a sh:NodeShape ;
    ont:hierarchyLevel 3 ;
    sh:targetClass geo:Feature ;
    sh:property [
        sh:path [ sh:inversePath rdfs:member ] ;
        sh:class geo:FeatureCollection ;
    ] , [
        sh:path ( [sh:inversePath rdfs:member ] [ sh:inversePath dcterms:hasPart ] );
        sh:class dcat:Catalog ;
    ] .

ex:ConceptSchemeConcept
    a sh:NodeShape ;
    ont:hierarchyLevel 3 ;
    sh:targetClass skos:Concept ;
    sh:property [
        sh:path skos:inScheme ;
        sh:class skos:ConceptScheme ;
    ] , [
        sh:path ( skos:inScheme [ sh:inversePath dcterms:hasPart ] );
        sh:class dcat:Catalog ;
    ] .

ex:CollectionConcept
    a sh:NodeShape ;
    ont:hierarchyLevel 3 ;
    sh:targetClass skos:Concept ;
    sh:property [
        sh:path [ sh:inversePath skos:member ] ;
        sh:class skos:Collection ;
    ] , [
        sh:path ( [ sh:inversePath skos:member ] [ sh:inversePath dcterms:hasPart ] );
        sh:class dcat:Catalog ;
    ] .

ex:Resource
    a sh:NodeShape ;
    ont:hierarchyLevel 3 ;
    sh:targetClass dcat:Resource ;
    sh:property [
        sh:path [ sh:inversePath dcterms:hasPart ] ;
        sh:class dcat:Catalog ;
    ] , [
        sh:path ( [ sh:inversePath dcterms:hasPart ] [ sh:inversePath dcterms:hasPart ] );
        sh:class dcat:Catalog ;
    ] .

ex:Profiles
    a sh:NodeShape ;
    ont:hierarchyLevel 1 ;
    sh:targetClass prof:Profile ;
.

ex:queryables a sh:NodeShape ;
    ont:hierarchyLevel 1 ;
    sh:rule [ sh:subject "?focus_node" ;
          sh:predicate <http://www.w3.org/1999/02/22-rdf-syntax-ns#type> ;
          sh:object <https://prez.dev/Queryable> ] ;
    ont:deliversClasses prez:QueryablesList ;
    sh:target [ sh:select """SELECT DISTINCT ?focus_node
             WHERE {
             ?s a ?class ;
                  ?focus_node ?o .
              VALUES ?class {
              dcat:Catalog
              dcat:Dataset
              dcat:Resource
              skos:ConceptScheme
              skos:Collection
              skos:Concept
              geo:FeatureCollection
              geo:Feature
              }
                    }""" ] ;
    shext:limit 100 ;
    shext:offset 0 ;
.